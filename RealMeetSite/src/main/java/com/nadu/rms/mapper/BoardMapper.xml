<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="com.nadu.rms.mapper.annotation.BoardMapper">

	<select id="selectBoards" parameterType="String" resultType="com.nadu.rms.vo.Board">
	<choose>
	<when test="param3 == null">
	SELECT * FROM (SELECT ROWNUM NUM, N.* FROM (SELECT * FROM NOTICES ORDER BY TO_NUMBER(NIDX) DESC) N)WHERE NUM BETWEEN ${param1} AND ${param2} 
	</when>
	<when test="param4 != null">
	<!-- SELECT * FROM (SELECT * FROM NOTICES WHERE ${param1} LIKE '%${param2}%' ORDER BY REGDATE DESC) -->
	SELECT * FROM (SELECT ROWNUM NUM, N.* FROM (SELECT * FROM NOTICES WHERE ${param3} LIKE '%${param4}%' ORDER BY REGDATE DESC) N) WHERE NUM BETWEEN ${param1} AND ${param2}
	</when>
	</choose>
	</select>

	
	<select id="selectBoardDetail" parameterType="Integer" resultType="com.nadu.rms.vo.Board">
	SELECT * FROM NOTICES WHERE NIDX = #{nidx}
	</select>
	
	<insert id="insertBoard" parameterType="com.nadu.rms.vo.Board">
	INSERT INTO NOTICES(NIDX, WRITER, TITLE, CONTENT, REGDATE) 
	VALUES(TO_CHAR(NOTICES_SEQ.NEXTVAL), #{writer, jdbcType=NVARCHAR}, #{title, jdbcType=VARCHAR}, #{content, jdbcType=VARCHAR}, SYSDATE)
	</insert>
	
	<update id="updateBoard" parameterType="com.nadu.rms.vo.Board">
	UPDATE NOTICES SET TITLE=#{title, jdbcType=VARCHAR}, CONTENT=#{content, jdbcType=VARCHAR}, REGDATE=SYSDATE WHERE NIDX = #{nidx, jdbcType=VARCHAR}
	</update>
	
	<delete id="delBoard" parameterType="String">
	DELETE FROM NOTICES WHERE NIDX = #{nidx, jdbcType=VARCHAR}
	</delete>
	
</mapper>